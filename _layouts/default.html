<!DOCTYPE html>
<html lang="{{ page.lang | default: site.lang | default: 'en' }}">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <title>{{ page.title }} | {{ site.title }}</title>
    <meta name="description" content="{{ page.excerpt | strip_html | strip_newlines | truncate: 160 }}">

    <!-- SEO and social sharing -->
    {% seo %}

    <!-- Default Minima styles -->
    <link rel="stylesheet" href="{{ '/assets/main.css' | relative_url }}">

    <!-- âœ… Your custom styles -->
    <link rel="stylesheet" href="{{ '/assets/css/custom.css' | relative_url }}">

    <!-- Favicon -->
    <link rel="icon" href="{{ '/favicon.ico' | relative_url }}">
  </head>

  <body>
    <!-- ðŸ”§ Header -->
    <header class="site-header">
      {% include header.html %}
    </header>

    <!-- ðŸ“„ Main content -->
    <main class="page-content" aria-label="Content">
      <div class="wrapper">
        {% if page.url == "/" %}
          <h2 class="section-title">ðŸ“Œ Latest</h2>
          <div class="post-grid">
            {% for post in site.posts limit:6 %}
              <div class="post-card">
                <a href="{{ post.url | relative_url }}">
                  <h3 class="post-title">{{ post.title }}</h3>
                </a>
                <p class="post-date">{{ post.date | date: "%b %d, %Y" }}</p>
                <p class="post-excerpt">{{ post.excerpt | strip_html | truncate: 100 }}</p>
              </div>
            {% endfor %}
          </div>
        {% else %}
          {{ content }}
        {% endif %}
      </div>
    </main>

    <!-- ðŸ’¬ Optional Giscus comment section -->
    {% if page.layout == "post" %}
    <div class="wrapper">
      <h2>ðŸ’¬ Comments</h2>
      <script src="https://giscus.app/client.js"
              data-repo="ysaak/your-repo-name"
              data-repo-id="YOUR_REPO_ID"
              data-category="General"
              data-category-id="YOUR_CATEGORY_ID"
              data-mapping="pathname"
              data-reactions-enabled="1"
              data-emit-metadata="0"
              data-theme="light"
              crossorigin="anonymous"
              async>
      </script>
    </div>
    {% endif %}

    <!-- ðŸ”» Footer -->
    <footer class="site-footer" style="text-align: center; font-size: 0.85rem; padding: 20px 0; background-color: #f9f9f9; color: #333;">
      <div>Powered by <strong>ASTROMub Limited</strong></div>
    </footer>

    <!-- ðŸš€ Animated Visitor Counter (Floating Bottom-Left) -->
    <div style="
      position: fixed;
      bottom: 10px;
      left: 10px;
      font-size: 0.85rem;
      background: rgba(255, 255, 255, 0.9);
      padding: 6px 10px;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
      z-index: 9999;
      font-family: sans-serif;
    ">
      Visitors: <span id="visitor-count">Loading...</span>
    </div>

    <script>
    fetch('https://ancient-cell-9c08.paanobaga.workers.dev/')
      .then(res => res.json())
      .then(data => {
        const target = data.visits || data.count || 0;
        const span = document.getElementById('visitor-count');
        let current = 0;
        const step = Math.ceil(target / 30); // speed of animation

        const animate = () => {
          current += step;
          if (current >= target) {
            span.textContent = target.toLocaleString();
          } else {
            span.textContent = current.toLocaleString();
            requestAnimationFrame(animate);
          }
        };

        animate();
      })
      .catch(err => {
        console.error("Visitor counter error:", err);
        document.getElementById('visitor-count').textContent = "N/A";
      });
    </script>
  </body>
</html>
